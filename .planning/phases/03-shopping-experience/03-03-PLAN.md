---
phase: 03-shopping-experience
plan: 03
type: execute
wave: 3
depends_on: ["03-02"]
files_modified:
  - src/app/commande/confirmation/[orderNumber]/page.tsx
  - src/components/order/OrderConfirmation.tsx
  - src/components/order/OrderDetails.tsx
  - src/components/order/index.ts
autonomous: true
---

<objective>
Create order confirmation page displaying order details after successful checkout.

Purpose: Provide customers with confirmation of their order including order number, items, shipping address, and next steps.
Output: Order confirmation page accessible via order number.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-shopping-experience/03-02-SUMMARY.md

@src/types/order.ts
@src/lib/orders.ts
@src/components/ui/Button.tsx
@src/components/ui/Container.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create order display components</name>
  <files>src/components/order/OrderDetails.tsx, src/components/order/OrderConfirmation.tsx, src/components/order/index.ts</files>
  <action>
Create components for displaying order information.

**src/components/order/OrderDetails.tsx:**
- Display order items: image, name, quantity, unit price, line total
- Subtotal, shipping (Gratuit), total
- Shipping address formatted (multi-line)
- Order date formatted in French locale

**src/components/order/OrderConfirmation.tsx:**
- Success message with checkmark icon (use simple SVG or unicode)
- "Merci pour votre commande!"
- Order number prominently displayed
- OrderDetails component
- "Un email de confirmation a ete envoye a [email]" (informational text, no actual email for MVP)
- "Continuer mes achats" button linking to /produits
- "Voir mes commandes" link (can link to /commande/suivi for future, or omit for MVP)

**src/components/order/index.ts:**
- Barrel export all components

Use existing design system colors and typography. Components are presentational (no state).
  </action>
  <verify>Components compile without TypeScript errors</verify>
  <done>Order display components created with proper French labels</done>
</task>

<task type="auto">
  <name>Task 2: Create order confirmation page</name>
  <files>src/app/commande/confirmation/[orderNumber]/page.tsx</files>
  <action>
Create dynamic order confirmation page.

**src/app/commande/confirmation/[orderNumber]/page.tsx:**
- Server component - fetches order by orderNumber param
- Page title/metadata: "Confirmation de commande [orderNumber] | Nuage"
- Use Container component
- Display OrderConfirmation with order data
- Handle order not found: show friendly message with link to home
- No caching needed (orders should reflect current state)

Page structure:
1. Header: "Commande confirmee"
2. OrderConfirmation component with full order details
3. Footer actions: Continue shopping, etc.
  </action>
  <verify>
1. Complete checkout flow
2. Arrive at /commande/confirmation/[orderNumber]
3. Order details display correctly
4. Order number matches
5. Invalid order number shows not-found message
  </verify>
  <done>Order confirmation page displays order details correctly</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete shopping experience flow: cart, checkout, and order confirmation</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/produits
    3. Add 2-3 products to cart (click "Ajouter au panier")
    4. Check: Cart icon in header shows correct count
    5. Visit: http://localhost:3000/panier
    6. Check: Cart shows correct items with images, prices, quantities
    7. Modify quantity, verify totals update
    8. Remove an item, verify it disappears
    9. Click "Passer la commande"
    10. Check: Redirected to /commande with order summary
    11. Fill shipping form with test data:
        - Prenom: Jean
        - Nom: Dupont
        - Email: jean@example.com
        - Telephone: 0612345678
        - Adresse: 123 Rue de la Paix
        - Ville: Paris
        - Code postal: 75001
    12. Click "Confirmer la commande"
    13. Check: Redirected to confirmation page
    14. Verify: Order number displayed, items listed, address shown
    15. Check: Cart is now empty (header count = 0)
    16. Refresh page: Confirmation still displays correctly
  </how-to-verify>
  <resume-signal>Type "approved" if the full flow works, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Order confirmation page accessible
- [ ] Order details display correctly
- [ ] Invalid order number handled gracefully
- [ ] Full flow: browse -> cart -> checkout -> confirmation works
- [ ] French labels throughout
</verification>

<success_criteria>

- All tasks completed
- Human verification approved
- No TypeScript or build errors
- Complete shopping flow functional
- Orders persisted correctly
- Cart clears after order placement
</success_criteria>

<output>
After completion, create `.planning/phases/03-shopping-experience/03-03-SUMMARY.md`
</output>
