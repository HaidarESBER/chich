---
phase: 08-character-delight
plan: 06
type: execute
wave: 2
depends_on: ["08-01"]
files_modified:
  - src/components/product/ImageZoom.tsx
  - src/components/product/Wishlist.tsx
  - src/components/product/ProductComparison.tsx
  - src/app/produits/[slug]/ProductDetailClient.tsx
  - src/contexts/WishlistContext.tsx
  - src/app/comparaison/page.tsx
autonomous: false
---

<objective>
Enhance product experience with advanced image zoom, wishlist functionality, and product comparison tool.

Purpose: Provide premium product exploration features that increase purchase confidence and enable informed decision-making.
Output: Professional e-commerce features matching luxury retail standards.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-character-delight/08-01-SUMMARY.md
@src/app/produits/[slug]/ProductDetailClient.tsx
@src/components/product/ProductCard.tsx
@src/contexts/CartContext.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create advanced image zoom with magnifying glass effect</name>
  <files>src/components/product/ImageZoom.tsx, src/app/produits/[slug]/ProductDetailClient.tsx</files>
  <action>
Build premium product image zoom for detailed inspection:

**Zoom interaction:**
- Hover over product image shows magnifying glass cursor
- Magnified area follows mouse position (lens effect)
- Zoom level: 2.5x magnification (adjustable)
- Magnified view shows in separate container next to image (desktop)
- Mobile: Tap image to toggle zoom, pinch-to-zoom support

**Desktop implementation:**
- Two-pane layout: Original image (left) + Zoomed view (right)
- Zoomed view appears on hover, hidden when mouse leaves
- Mouse position determines zoomed area (coordinate mapping)
- Smooth lens movement (follow mouse with slight lag for premium feel)
- Crosshair indicator on original image shows zoom area

**Mobile implementation:**
- Double-tap or pinch gesture activates zoom
- Zoomed image fills viewport, draggable
- Return to normal: tap "Fermer" button or pinch out
- Use transform: scale() for performant zoom
- Prevent body scroll when zoomed

**Visual design:**
- Magnifying lens: circular overlay with border
- Zoomed container: subtle border, white background
- Loading indicator while high-res image loads
- Smooth transitions (transform, opacity)

**Technical implementation:**
- Calculate mouse position relative to image bounds
- Map mouse coordinates to zoomed image position
- Use CSS transform for smooth zoomed image movement
- Lazy load high-resolution image for zoom (2x source image size)
- Touch events: touchmove for drag, gesturestart for pinch

**Integration:**
- Enhance existing ProductDetailClient gallery
- Add zoom icon indicator (magnifying glass) on image corner
- "Cliquez pour zoomer" tooltip on desktop hover
  </action>
  <verify>Hover shows magnified view smoothly, mobile tap/pinch zooms correctly, zoomed image crisp and detailed</verify>
  <done>Image zoom professional and smooth, magnification clear, both desktop and mobile interactions polished</done>
</task>

<task type="auto">
  <name>Task 2: Create wishlist system with persistent storage and heart icon</name>
  <files>src/components/product/Wishlist.tsx, src/contexts/WishlistContext.tsx, src/components/product/ProductCard.tsx, src/app/produits/[slug]/ProductDetailClient.tsx</files>
  <action>
Build wishlist/favorites feature for product saving:

**WishlistContext (similar to CartContext):**
- State: wishlist items (array of product IDs)
- Actions: addToWishlist, removeFromWishlist, isInWishlist, clearWishlist
- Persistence: localStorage (key: 'nuage-wishlist')
- Provider wraps app in layout.tsx

**Heart icon button:**
- Positioned top-right on ProductCard (absolute, overlays image)
- Also below product name on ProductDetailClient page
- Filled heart: product in wishlist (red/blush color #D4A5A5)
- Outline heart: product not in wishlist (charcoal stroke)
- Click toggles wishlist state

**Heart animation:**
- Adding to wishlist: heart scales with spring (1 → 1.3 → 1) + fill color transition
- Removing: scale pulse + outline transition
- Haptic feedback simulation (scale pulse on click)
- Use Framer Motion for smooth spring animations

**Wishlist page (/favoris):**
- Grid layout showing all wishlist products
- "Votre liste de souhaits (X produits)"
- Empty state: Heart icon + "Aucun produit dans vos favoris"
- Each product: Image, name, price, "Ajouter au panier" button, Remove (X) button
- Quick add to cart from wishlist
- Share wishlist button (copy link, future feature placeholder)

**Visual design:**
- Heart icon: 24px on cards, 32px on detail page
- Wishlist badge in header (heart icon + count, similar to cart)
- Wishlist count animates when items added/removed
- Brand colors: blush for filled heart, charcoal for outline

**Integration:**
- Add WishlistContext provider to layout.tsx
- Add heart button to ProductCard (top-right overlay)
- Add heart button to ProductDetailClient (below title, inline)
- Create /favoris page with wishlist grid
- Add wishlist link to header navigation (heart icon + count)

**Analytics placeholder:**
- Track events: wishlistAdded, wishlistRemoved, wishlistViewed
- Wishlist conversion tracking (items added to cart from wishlist)
  </action>
  <verify>Heart icon toggles wishlist state, animation smooth, wishlist persists across page reloads, /favoris page shows saved products</verify>
  <done>Wishlist system fully functional, heart animations delightful, persistence working, dedicated page polished</done>
</task>

<task type="auto">
  <name>Task 3: Build product comparison tool for side-by-side evaluation</name>
  <files>src/components/product/ProductComparison.tsx, src/app/comparaison/page.tsx, src/components/product/ProductCard.tsx</files>
  <action>
Create comparison feature for evaluating multiple products:

**Comparison mechanism:**
- "Comparer" button on ProductCard (appears on hover, next to quick-view)
- Click adds product to comparison list (max 3 products)
- Comparison button in header shows count: "Comparer (2)"
- Clicking header button navigates to /comparaison page

**Comparison page (/comparaison):**
- Side-by-side table layout (desktop) or stacked cards (mobile)
- Columns: Product image, Name, Price, Rating, Stock status, Category, Description
- Each product column has "Ajouter au panier" and "Retirer" buttons
- Highlight differences (e.g., price differences in color: lowest = green accent)

**Comparison state:**
- React Context: ComparisonContext (similar to Cart/Wishlist)
- Actions: addToComparison, removeFromComparison, clearComparison
- Persistence: sessionStorage (temporary - clears on session end)
- Max 3 products (show toast notification if user tries to add 4th)

**Table design:**
- Header row: Sticky on scroll
- Product images: 200x200px, same size for fair comparison
- Attributes aligned for easy scanning
- Alternate row background colors for readability
- Responsive: Horizontal scroll on tablet, stacked on mobile

**Empty state:**
- "Sélectionnez des produits à comparer"
- Link to catalog page
- Visual: Comparison icon (scales/balance icon)

**Mobile optimization:**
- Swipeable cards instead of table (swipe to see next product)
- Attribute pairs stacked vertically
- Comparison drawer/bottom sheet (reuse from 08-04)

**Integration:**
- Add ComparisonContext provider to layout.tsx
- Add "Comparer" button to ProductCard
- Add comparison indicator to header (icon + count badge)
- Create /comparaison page with comparison table
- Toast notifications: "Produit ajouté à la comparaison" with undo option
  </action>
  <verify>Products add to comparison list, /comparaison page shows side-by-side table, differences highlighted, max 3 enforced</verify>
  <done>Comparison tool functional and intuitive, table layout clear, mobile adaptation smooth, persistence working</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Enhanced product experience: magnifying glass zoom, wishlist with heart animations, product comparison tool</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. **Test Image Zoom:**
       - Visit any product detail page
       - Desktop: Hover over product image, verify magnified view appears
       - Check magnified view is crisp and follows mouse smoothly
       - Mobile: Tap image and verify zoom activates
       - Test pinch-to-zoom gesture on mobile
       - Confirm zoom controls feel natural and smooth
    3. **Test Wishlist:**
       - Click heart icon on ProductCard (top-right)
       - Verify heart fills with animation (spring scale effect)
       - Check heart persists as filled on page reload
       - Click filled heart to remove, verify outline animation
       - Visit /favoris page, confirm wishlisted products display
       - Add product to cart from wishlist page
       - Test empty wishlist state (remove all items)
       - Check header wishlist badge shows count
    4. **Test Product Comparison:**
       - Hover over ProductCard, click "Comparer" button
       - Add 2-3 products to comparison
       - Verify header shows comparison count
       - Click header comparison button to navigate to /comparaison
       - Check products display side-by-side in table
       - Verify price differences highlighted (if any)
       - Test "Ajouter au panier" from comparison page
       - Try adding 4th product, verify max 3 enforcement (toast message)
       - Mobile: Check comparison layout adapts (stacked or swipeable)
       - Test "Retirer" button removes product from comparison
    5. **Overall quality check:**
       - Image zoom magnification clear and smooth
       - Wishlist heart animations delightful and spring-based
       - Comparison table layout clean and easy to scan
       - All features work on mobile and desktop
       - Persistence works (localStorage/sessionStorage)
       - No performance issues or UI glitches
       - Features feel premium and professional
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe specific issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds with no errors
- [ ] Image zoom magnifies correctly on desktop and mobile
- [ ] Wishlist adds/removes products with heart animation
- [ ] Wishlist persists across page reloads (localStorage)
- [ ] Comparison adds max 3 products with enforcement
- [ ] Comparison page shows side-by-side table clearly
- [ ] All features mobile-responsive
- [ ] Context providers integrated correctly
- [ ] Routes /favoris and /comparaison functional
- [ ] Animations smooth and premium
</verification>

<success_criteria>

- All tasks completed
- Image zoom provides detailed product inspection
- Wishlist enables easy product saving
- Comparison tool aids purchase decisions
- All features professionally designed
- Mobile and desktop experiences optimized
- Persistence working (localStorage/sessionStorage)
- User tested and approved all features
- No performance regressions
  </success_criteria>

<output>
After completion, create `.planning/phases/08-character-delight/08-06-SUMMARY.md`
</output>
