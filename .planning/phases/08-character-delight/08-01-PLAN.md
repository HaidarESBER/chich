---
phase: 08-character-delight
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/product/ProductSearch.tsx
  - src/components/product/ProductFilters.tsx
  - src/components/product/ProductSort.tsx
  - src/components/product/QuickViewModal.tsx
  - src/components/product/ProductGrid.tsx
  - src/app/produits/page.tsx
autonomous: true
---

<objective>
Implement advanced product browsing with search, filters, sorting, and quick-view modal for premium catalog experience.

Purpose: Enable customers to find products effortlessly with instant search, precise filtering, and quick product preview without page navigation.
Output: Professional product discovery system matching luxury e-commerce standards.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/product/ProductGrid.tsx
@src/app/produits/page.tsx
@src/data/products.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create product search with instant autocomplete</name>
  <files>src/components/product/ProductSearch.tsx</files>
  <action>
Create client component with search input that filters products in real-time:
- Debounced search (300ms delay) to avoid excessive re-renders
- Search across product name, description, category
- Show autocomplete dropdown with matching products (max 5 results)
- Each result shows product name, price, thumbnail (40x40px)
- Clicking result navigates to product detail page
- ESC key clears search and closes dropdown
- Click outside closes dropdown
- Animate dropdown with Framer Motion (slide down + fade)
- Use existing brand styling (Cormorant Garamond headings, Inter body)
- Magnifying glass icon in input field

Export search state hook: useProductSearch(products) that other components can consume.
  </action>
  <verify>Search "chicha" shows matching products in dropdown, ESC clears, clicking result navigates correctly</verify>
  <done>Search component filters products instantly, dropdown animates smoothly, keyboard navigation works</done>
</task>

<task type="auto">
  <name>Task 2: Create filter system for category, price range, and stock status</name>
  <files>src/components/product/ProductFilters.tsx</files>
  <action>
Create client component with collapsible filter sections:

**Category filter:**
- Extract unique categories from products
- Checkbox list with category names and count "(3)"
- Multiple selection allowed

**Price filter:**
- Dual-range slider (min/max) using HTML input type="range"
- Display current range: "€XX - €YY"
- Min: 0, Max: highest product price + 10€ buffer
- Steps of €5

**Stock filter:**
- Single checkbox: "En stock uniquement"
- Filters out products with inStock=false

**UI:**
- Each section collapsible with chevron icon
- Default: all sections expanded
- "Réinitialiser les filtres" button clears all (appears when filters active)
- Animate filter panel with Framer Motion
- Mobile: Filters in slide-out panel (prepare for 08-04 mobile bottom sheet)
- Desktop: Sidebar layout

Export filter state hook: useProductFilters(products) → filteredProducts.
  </action>
  <verify>Filters work independently and combined, price slider updates smoothly, reset clears all selections</verify>
  <done>Filter system filters products correctly, UI is intuitive, animations smooth, filter state hook exported</done>
</task>

<task type="auto">
  <name>Task 3: Add sort dropdown with multiple options</name>
  <files>src/components/product/ProductSort.tsx</files>
  <action>
Create sort dropdown component:

**Sort options:**
- "Pertinence" (default - featured products first)
- "Prix croissant" (low to high)
- "Prix décroissant" (high to low)
- "Nouveautés" (newest first - use product.createdAt if exists, else product order)
- "Popularité" (use product.featured flag or view count if tracked)

**UI:**
- Custom select dropdown (not native <select> - styled for premium feel)
- Shows current selection: "Trier par: Prix croissant"
- Clicking opens dropdown with all options
- Checkmark icon next to selected option
- Animate dropdown with Framer Motion (fade + slide down)
- ChevronDown icon that rotates 180° when open

**Implementation:**
- Use state for open/closed
- Click outside closes dropdown
- ESC key closes dropdown
- Apply sort to product array passed as prop

Export sort hook: useProductSort(products, sortOption) → sortedProducts.
  </action>
  <verify>Sort dropdown changes product order correctly, animations smooth, keyboard controls work</verify>
  <done>Sort works for all options, dropdown styled premium, animations polish, hook exported</done>
</task>

<task type="auto">
  <name>Task 4: Create quick-view modal for product preview</name>
  <files>src/components/product/QuickViewModal.tsx, src/components/product/ProductCard.tsx</files>
  <action>
Create modal component that shows product preview without full navigation:

**Modal content:**
- Product image gallery (thumbnails + main image, reuse gallery from ProductDetailClient)
- Product name, price, description (truncated to 3 lines)
- "Ajouter au panier" button with quantity selector
- "Voir les détails" link to full product page
- Close button (X icon) + ESC key + click backdrop to close
- Body scroll lock when modal open

**Trigger:**
- Add "Aperçu rapide" button to ProductCard (appears on hover, overlays image)
- Eye icon + text
- Opens QuickViewModal with product data

**UI:**
- Modal slides up from center with scale animation (0.95 → 1)
- Backdrop: charcoal with 40% opacity
- Max width: 800px
- Responsive: Full screen on mobile (<768px)
- Use Framer Motion AnimatePresence for entrance/exit

**Integration:**
- Add modal state to ProductCard
- Pass product data to QuickViewModal
- Use portal (React createPortal) to render at document.body level
  </action>
  <verify>Quick-view opens on ProductCard hover button click, modal content complete, adding to cart works, closing with X/ESC/backdrop works</verify>
  <done>Quick-view modal fully functional, animations premium, accessible (keyboard), integrates with ProductCard</done>
</task>

<task type="auto">
  <name>Task 5: Integrate search, filters, and sort into product catalog page</name>
  <files>src/app/produits/page.tsx</files>
  <action>
Convert product catalog page to client component and integrate all browsing features:

**Layout:**
- Top: ProductSearch (full width, prominent)
- Below search: ProductSort dropdown (right-aligned) + result count (left: "24 produits")
- Left sidebar: ProductFilters (desktop only, 280px width)
- Main area: ProductGrid with filtered/sorted products
- Mobile: Filters button opens bottom sheet (placeholder for 08-04)

**State management:**
- Combine search, filter, and sort hooks
- Apply in order: search → filter → sort → display
- Show "Aucun produit trouvé" empty state with clear filters button if 0 results
- Preserve product grid animations from Phase 5 (scroll-triggered entrance)

**URL state (bonus):**
- Sync filters/search to URL params for shareable links
- useSearchParams + useRouter for state persistence
- Example: /produits?search=chicha&category=accessoires&sort=price-asc

**Performance:**
- Memoize filtered/sorted results with useMemo
- Debounce search input to avoid excessive filtering
  </action>
  <verify>All features work together, filtering/sorting/searching updates grid in real-time, URL params sync, empty state shows correctly</verify>
  <done>Product catalog page is fully interactive, all browsing features integrated, performance optimized, URL state working</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds with no errors
- [ ] Search autocomplete works instantly with dropdown
- [ ] Filters apply correctly (category, price, stock)
- [ ] Sort changes product order as expected
- [ ] Quick-view modal opens from ProductCard
- [ ] All features work together on catalog page
- [ ] URL params sync with filter state
- [ ] Empty state shows when no results
- [ ] Mobile layout adapts (filters button placeholder)
- [ ] All animations smooth and premium
</verification>

<success_criteria>

- All tasks completed
- Product browsing is premium and effortless
- Search finds products instantly
- Filters narrow results precisely
- Sort organizes products as expected
- Quick-view previews without navigation
- Integration seamless on catalog page
- Performance excellent (no lag)
- Mobile-responsive layout
  </success_criteria>

<output>
After completion, create `.planning/phases/08-character-delight/08-01-SUMMARY.md`
</output>
