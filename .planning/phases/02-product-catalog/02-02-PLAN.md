---
phase: 02-product-catalog
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified: [src/app/admin/page.tsx, src/app/admin/produits/page.tsx, src/app/admin/produits/[id]/page.tsx, src/app/admin/produits/nouveau/page.tsx, src/app/admin/layout.tsx, src/components/admin/ProductForm.tsx, src/components/admin/index.ts, src/lib/products.ts]
autonomous: false
---

<objective>
Create admin interface for product management (CRUD operations).

Purpose: Enable manual product data entry and editing without code changes.
Output: Working admin dashboard with product list, create, edit, and delete functionality.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-product-catalog/02-01-SUMMARY.md

@src/types/product.ts
@src/data/products.ts
@src/components/ui/Button.tsx
@src/components/ui/Container.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create product data management utilities</name>
  <files>src/lib/products.ts</files>
  <action>
Create server-side product management utilities in src/lib/products.ts:
- Use file-system based storage for simplicity (JSON file at data/products.json)
- Functions with "use server" directive for Server Actions:
  - getAllProducts(): Promise<Product[]>
  - getProductById(id: string): Promise<Product | null>
  - createProduct(data: Omit<Product, 'id' | 'slug'>): Promise<Product>
  - updateProduct(id: string, data: Partial<Product>): Promise<Product>
  - deleteProduct(id: string): Promise<void>
- Auto-generate slug from name (slugify: lowercase, replace spaces with hyphens, remove special chars)
- Auto-generate UUID for new products
- Read/write to data/products.json file
- Initialize with sample data if file doesn't exist

Note: This is a simple file-based approach for MVP. Real database can be added later.
  </action>
  <verify>Functions compile, can read sample products</verify>
  <done>Product CRUD utilities work with file-based storage</done>
</task>

<task type="auto">
  <name>Task 2: Create admin layout and dashboard</name>
  <files>src/app/admin/layout.tsx, src/app/admin/page.tsx</files>
  <action>
Create admin layout (src/app/admin/layout.tsx):
- Simple sidebar navigation: Dashboard, Produits
- Main content area with padding
- "Nuage Admin" header
- Minimal styling - functional, not fancy
- Use brand colors but simpler than public site

Create admin dashboard (src/app/admin/page.tsx):
- Welcome message
- Quick stats: Total products, Featured products, Out of stock count
- Quick link to "Ajouter un produit"

Note: No authentication for MVP - admin routes are not protected yet.
  </action>
  <verify>Admin layout renders, dashboard shows stats</verify>
  <done>Admin area accessible at /admin with navigation</done>
</task>

<task type="auto">
  <name>Task 3: Create ProductForm component</name>
  <files>src/components/admin/ProductForm.tsx, src/components/admin/index.ts</files>
  <action>
Create ProductForm component for create/edit:
- Props: initialData (optional Product for edit mode), onSubmit (Server Action)
- Fields:
  - name (text input, required)
  - shortDescription (text input)
  - description (textarea)
  - price (number input, in EUR - convert to/from cents)
  - compareAtPrice (number input, optional - for sales)
  - category (select dropdown with ProductCategory options)
  - images (text input for URLs, comma-separated for now)
  - inStock (checkbox)
  - featured (checkbox)
- Form validation: name required, price required and positive
- Submit button: "Enregistrer"
- Use brand Button component for submit
- Form styling: labels above inputs, generous spacing, border on inputs

Create barrel export in src/components/admin/index.ts
  </action>
  <verify>Form renders with all fields, validation works</verify>
  <done>ProductForm handles both create and edit modes</done>
</task>

<task type="auto">
  <name>Task 4: Create product list and CRUD pages</name>
  <files>src/app/admin/produits/page.tsx, src/app/admin/produits/nouveau/page.tsx, src/app/admin/produits/[id]/page.tsx</files>
  <action>
Create product list page (src/app/admin/produits/page.tsx):
- Table displaying all products: Image thumbnail, Name, Price, Category, Stock status, Actions
- Actions column: Edit link, Delete button
- "Ajouter un produit" button at top
- Delete with confirmation (window.confirm for simplicity)
- Revalidate page after delete

Create new product page (src/app/admin/produits/nouveau/page.tsx):
- "Nouveau Produit" heading
- ProductForm with empty initial data
- On submit: createProduct(), redirect to product list
- "Retour" link to product list

Create edit product page (src/app/admin/produits/[id]/page.tsx):
- "Modifier le Produit" heading
- Load product by ID, show notFound() if not found
- ProductForm with product data as initialData
- On submit: updateProduct(), redirect to product list
- "Retour" link to product list
  </action>
  <verify>Product CRUD operations work end-to-end</verify>
  <done>Can create, view, edit, and delete products from admin</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Admin interface for product management with CRUD operations</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/admin
    3. Check: Dashboard shows product stats
    4. Navigate to: Produits list
    5. Click: "Ajouter un produit"
    6. Fill form: Create a test product with all fields
    7. Submit: Verify product appears in list
    8. Edit: Click edit on a product, change price, save
    9. Delete: Delete the test product with confirmation
    10. Verify: Public /produits page still shows products
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Admin dashboard accessible at /admin
- [ ] Product list shows all products
- [ ] Can create new product via form
- [ ] Can edit existing product
- [ ] Can delete product with confirmation
- [ ] Changes persist (saved to JSON file)
- [ ] Public catalog reflects admin changes
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human verification approved
- Product CRUD operations work end-to-end
- Admin interface is functional and usable
</success_criteria>

<output>
After completion, create `.planning/phases/02-product-catalog/02-02-SUMMARY.md`
</output>
